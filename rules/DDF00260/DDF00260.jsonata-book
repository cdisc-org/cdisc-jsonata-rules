[{"kind":1,"language":"markdown","value":"Import utility functions","outputs":[]},{"kind":2,"language":"jsonata","value":"$utils := $merge([$import(\"./utils/get_idmap.jsonata\")\r\n                 ,$import(\"./utils/get_maxids.jsonata\")\r\n                 ,$import(\"./utils/make_dup.jsonata\")\r\n                 ,$import(\"./utils/get_rule.jsonata\")\r\n                 ,$import(\"./utils/add_path.jsonata\")\r\n                 ,$import(\"./utils/report.jsonata\")]) ","outputs":[]},{"kind":1,"language":"markdown","value":"Define test","outputs":[]},{"kind":2,"language":"jsonata","value":"$rule := $utils.get_rule($import(\"./rules/DDF00260/DDF00260.json\"))","outputs":[]},{"kind":1,"language":"markdown","value":"Create test data","outputs":[]},{"kind":2,"language":"jsonata","value":"(\r\n    /***********************************************************************\\\r\n    * Use the CDISC Pilot data as a start point                             *\r\n    \\***********************************************************************/\r\n\r\n    $old_study :=   $loadFile(\"./testdata/CDISC_Pilot_Study.json\");\r\n\r\n    /***********************************************************************\\\r\n    * Write out as positive unit test data.                                 *\r\n    \\***********************************************************************/\r\n    $writeFile(\"./rules/DDF00260/unit-test-coreid-DDF00260-positive.json\",$old_study);\r\n    \r\n    /***********************************************************************\\\r\n    * Add the following invalid references and then write out as negative   *\r\n    * unit test data:                                                       *\r\n    * - Add spaces in various places in the id value of 10 randomly         *\r\n    *   selected instances.                                                 *\r\n    \\***********************************************************************/\r\n    $new_study1 :=  $old_study\r\n                    ~> |study.versions[0].**[id=\"Activity_28\"]|{\"id\": \"Activity 28\"}|\r\n                    ~> |study.versions[0].**[id=\"Objective_4\"]|{\"id\": \"Objective_4 \"}|\r\n                    ~> |study.versions[0].**[id=\"NarrativeContentItem_53\"]|{\"id\": \"Narrative Content Item 53\"}|\r\n                    ~> |study.versions[0].**[id=\"Quantity_4\"]|{\"id\": \" Quantity_4\"}|\r\n                    ~> |study.versions[0].**[id=\"ResponseCode_69\"]|{\"id\": \"Response Code_69\"}|\r\n                    ~> |study.versions[0].**[id=\"ResponseCode_165\"]|{\"id\": \"ResponseCode_165    \"}|\r\n                    ~> |study.versions[0].**[id=\"ParameterMap_4\"]|{\"id\": \"  ParameterMap_4  \"}|\r\n                    ~> |study.versions[0].**[id=\"Code_166\"]|{\"id\": \" Code 166 \"}|\r\n                    ~> |study.versions[0].**[id=\"Code_445\"]|{\"id\": \"Code   445\"}|\r\n                    ~> |study.versions[0].**[id=\"Code_571\"]|{\"id\": \"                        Code_571                     \"}|;\r\n    $writeFile(\"./rules/DDF00260/unit-test-coreid-DDF00260-negative.json\",$new_study1);\r\n)","outputs":[]},{"kind":1,"language":"markdown","value":"Test positive data","outputs":[]},{"kind":2,"language":"jsonata","value":"(\r\n    $pos_data := $loadFile(\"./rules/DDF00260/unit-test-coreid-DDF00260-positive.json\");\r\n    $utils.report($rule,$pos_data);\r\n)","outputs":[]},{"kind":1,"language":"markdown","value":"Test negative data","outputs":[]},{"kind":2,"language":"jsonata","value":"(\r\n    $neg_data := $loadFile(\"./rules/DDF00260/unit-test-coreid-DDF00260-negative.json\");\r\n    $utils.report($rule,$neg_data)\r\n)","outputs":[]}]