Authorities:
  - Organization: CDISC
    Standards:
      - Name: USDM
        References:
          - Citations:
              - Cited Guidance: 'Each defined eligibility criterion must be used by at least one
                  study population or cohort within the same study design.'
                Document: 'USDM_CORE_Rules.xlsx'
            Origin: 'USDM Conformance Rules'
            Rule Identifier:
              Id: 'DDF00158'
              Version: '1'
            Version: '1.0'
        Version: '4.0'
Check: |-
  ($.**.studyDesigns)@$s.
    $s.eligibilityCriteria@$ec
      [
        $not($ec.id in $append($s.population.criterionIds,$s.population.cohorts.criterionIds))
      ].
      {
        "instanceType": $ec.instanceType,
        "id": $ec.id,
        "path": $ec._path,
        "StudyDesign.id": $s.id,
        "StudyDesign.name": $s.name,
        "name": $ec.name,
        "category": $ec.category.decode,
        "identifier": $ec.identifier
      }
Core:
  Id: 'DDF00158'
  Status: Draft
  Version: '1'
Description: 'Each defined eligibility criterion must be used by at least one
  study population or cohort within the same study design.'
Executability: Fully Executable
Outcome:
  Message: "The eligibility criterion is not referenced by the study design's
    population or any of its cohorts."
  Output Variables:
    - StudyDesign.id
    - StudyDesign.name
    - name
    - category
    - identifier
Rule Type: JSONata
Scope:
  Entities:
    Include:
      - 'EligibilityCriterion'
Sensitivity: Record
