[{"kind":1,"language":"markdown","value":"Define test","outputs":[]},{"kind":2,"language":"jsonata","value":"(\r\n    $utils := $import(\"./utils/parent_rel.jsonata\");\r\n    $rule := $import(\"./rules/DDF00083/DDF00083.jsonata\");\r\n)\r\n                            ","outputs":[{"mime":"text/x-json","value":{"ddf00083":{"_jsonata_lambda":true,"input":{},"environment":{"timestamp":"2025-06-03T12:37:02.095Z","async":false,"isParallelCall":false,"global":{"ancestry":[null]}},"arguments":[{"value":"data","type":"variable","position":34}],"body":{"type":"block","position":85,"expressions":[{"type":"bind","value":":=","position":125,"lhs":{"value":"output","type":"variable","position":122},"rhs":{"type":"apply","value":"~>","position":817,"lhs":{"type":"path","steps":[{"type":"block","position":127,"expressions":[{"value":"data","type":"variable","position":132}]},{"value":"**","type":"descendant","position":136},{"value":"*","type":"wildcard","position":138,"stages":[{"type":"filter","expr":{"type":"binary","value":"and","position":145,"lhs":{"type":"path","steps":[{"value":"id","type":"name","position":141}]},"rhs":{"type":"path","steps":[{"value":"instanceType","type":"name","position":158}]}},"position":139}],"ancestor":{"label":"!0","level":0,"index":3},"tuple":true},{"type":"unary","value":"{","position":161,"seekingParent":[{"label":"!0","level":0,"index":0},{"label":"!0","level":0,"index":1},{"label":"!0","level":0,"index":2},{"label":"!0","level":0,"index":3}],"lhs":[[{"value":"id","type":"string","position":199},{"type":"path","steps":[{"value":"id","type":"name","position":203}]}],[{"value":"instance","type":"string","position":215},{"type":"unary","value":"{","position":218,"seekingParent":[{"label":"!0","level":0,"index":0},{"label":"!0","level":0,"index":1},{"label":"!0","level":0,"index":2},{"label":"!0","level":0,"index":3}],"lhs":[[{"value":"id","type":"string","position":268},{"type":"path","steps":[{"value":"id","type":"name","position":272}]}],[{"value":"instanceType","type":"string","position":334},{"type":"path","steps":[{"value":"instanceType","type":"name","position":348}]}],[{"value":"name","type":"string","position":402},{"type":"path","steps":[{"value":"name","type":"name","position":408}]}],[{"value":"parent_id","type":"string","position":467},{"type":"path","steps":[{"type":"parent","slot":{"label":"!0","level":0,"index":0}},{"value":"id","type":"name","position":473}],"seekingParent":[{"label":"!0","level":0,"index":0},{"label":"!0","level":0,"index":1},{"label":"!0","level":0,"index":2},{"label":"!0","level":0,"index":3}]}],[{"value":"parent_entity","type":"string","position":535},{"type":"path","steps":[{"type":"parent","slot":{"label":"!0","level":0,"index":1}},{"value":"instanceType","type":"name","position":551}],"seekingParent":[{"label":"!0","level":0,"index":1}]}],[{"value":"parent_name","type":"string","position":611},{"type":"path","steps":[{"type":"parent","slot":{"label":"!0","level":0,"index":2}},{"value":"name","type":"name","position":619}],"seekingParent":[{"label":"!0","level":0,"index":2}]}],[{"value":"parent_rel","type":"string","position":678},{"type":"block","position":681,"seekingParent":[{"label":"!0","level":0,"index":3}],"expressions":[{"type":"bind","value":":=","position":691,"lhs":{"value":"parent","type":"variable","position":688},"rhs":{"type":"parent","slot":{"label":"!0","level":0,"index":3}},"seekingParent":[{"label":"!0","level":0,"index":3}]},{"type":"path","steps":[{"value":"utils","type":"variable","position":701},{"type":"function","value":"(","position":713,"arguments":[{"value":"","type":"variable","position":714},{"value":"parent","type":"variable","position":722}],"procedure":{"type":"path","steps":[{"value":"parent_rel","type":"name","position":712}]}}]}]}]]}]]},{"value":"","type":"variable","position":800}],"group":{"lhs":[[{"type":"path","steps":[{"value":"id","type":"name","position":803}]},{"type":"path","steps":[{"value":"instance","type":"name","position":813}]}]],"position":801}},"rhs":{"type":"function","value":"(","position":824,"arguments":[{"type":"lambda","arguments":[{"value":"v","type":"variable","position":835}],"position":833,"body":{"type":"binary","value":">","position":849,"lhs":{"type":"function","value":"(","position":844,"arguments":[{"value":"v","type":"variable","position":846}],"procedure":{"value":"count","type":"variable","position":843}},"rhs":{"value":1,"type":"number","position":851}}}],"procedure":{"value":"sift","type":"variable","position":823}}}}]}}}}]},{"kind":1,"language":"markdown","value":"Test positive data","outputs":[]},{"kind":2,"language":"jsonata","value":"(\r\n    $neg_data := $loadFile(\"./rules/DDF00083/DDF00083-positive.json\");\r\n    $dups := $rule.ddf00083($neg_data)\r\n)","outputs":[{"mime":"text/x-json","value":"undefined"}]},{"kind":1,"language":"markdown","value":"Test negative data","outputs":[]},{"kind":2,"language":"jsonata","value":"(\r\n    $neg_data := $loadFile(\"./rules/DDF00083/DDF00083-negative.json\");\r\n    $dups := $rule.ddf00083($neg_data)\r\n)","outputs":[{"mime":"text/x-json","value":{"AliasCode_241":[{"id":"AliasCode_241","instanceType":"AliasCode","parent_id":"Quantity_9","parent_entity":"Quantity","parent_rel":"unit"},{"id":"AliasCode_241","instanceType":"AliasCode","parent_id":"Quantity_10","parent_entity":"Quantity","parent_rel":"unit"}],"Code_608":[{"id":"Code_608","instanceType":"Code","parent_id":"AliasCode_241","parent_entity":"AliasCode","parent_rel":"standardCode"},{"id":"Code_608","instanceType":"Code","parent_id":"AliasCode_241","parent_entity":"AliasCode","parent_rel":"standardCode"}],"Code_12":[{"id":"Code_12","instanceType":"Code","parent_id":"StudyDefinitionDocumentVersion_1","parent_entity":"StudyDefinitionDocumentVersion","parent_rel":"status"},{"id":"Code_12","instanceType":"Code","parent_id":"StudyDefinitionDocumentVersion_2","parent_entity":"StudyDefinitionDocumentVersion","parent_rel":"status"}],"GovernanceDate_2":[{"id":"GovernanceDate_2","instanceType":"GovernanceDate","name":"P_APPROVE","parent_id":"StudyDefinitionDocumentVersion_1","parent_entity":"StudyDefinitionDocumentVersion","parent_rel":"dateValues"},{"id":"GovernanceDate_2","instanceType":"GovernanceDate","name":"P_APPROVE","parent_id":"StudyDefinitionDocumentVersion_2","parent_entity":"StudyDefinitionDocumentVersion","parent_rel":"dateValues"}],"Code_15":[{"id":"Code_15","instanceType":"Code","parent_id":"GovernanceDate_2","parent_entity":"GovernanceDate","parent_name":"P_APPROVE","parent_rel":"type"},{"id":"Code_15","instanceType":"Code","parent_id":"GovernanceDate_2","parent_entity":"GovernanceDate","parent_name":"P_APPROVE","parent_rel":"type"}],"GeographicScope_2":[{"id":"GeographicScope_2","instanceType":"GeographicScope","parent_id":"GovernanceDate_2","parent_entity":"GovernanceDate","parent_name":"P_APPROVE","parent_rel":"geographicScopes"},{"id":"GeographicScope_2","instanceType":"GeographicScope","parent_id":"GovernanceDate_2","parent_entity":"GovernanceDate","parent_name":"P_APPROVE","parent_rel":"geographicScopes"}],"Code_17":[{"id":"Code_17","instanceType":"Code","parent_id":"GeographicScope_2","parent_entity":"GeographicScope","parent_rel":"type"},{"id":"Code_17","instanceType":"Code","parent_id":"GeographicScope_2","parent_entity":"GeographicScope","parent_rel":"type"}],"AliasCode_1":[{"id":"AliasCode_1","instanceType":"AliasCode","parent_id":"GeographicScope_2","parent_entity":"GeographicScope","parent_rel":"code"},{"id":"AliasCode_1","instanceType":"AliasCode","parent_id":"GeographicScope_2","parent_entity":"GeographicScope","parent_rel":"code"}],"Code_16":[{"id":"Code_16","instanceType":"Code","parent_id":"AliasCode_1","parent_entity":"AliasCode","parent_rel":"standardCode"},{"id":"Code_16","instanceType":"Code","parent_id":"AliasCode_1","parent_entity":"AliasCode","parent_rel":"standardCode"}]}}]}]